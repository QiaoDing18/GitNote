title: 垃圾回收、基本类型、引用类型
author: 乔丁
tags:
  - 前端
categories:
  - web
date: 2018-04-27 17:22:00
photos: http://p7wm7amg2.bkt.clouddn.com/pig.png
---

## 基本类型和引用类型的值
js变量是松散类型，所谓松散类型就是可以保存任何类型的数据。换句话说，每个变量仅仅是一个用于保存值的占位符而已。由于不存在定义某个变量必须要保存任何数据类型值的规则，变量的值及数据类型可以在脚本的生命周期内改变。**基本类型是指简单的数据段**，**引用类型是指那些可能由多个值构成的对象**
5种基本数据类型：Undefined、Null、Boolean、Number和String。
这五种基本类型是按值访问的，因为可以操作保存在变量的实际的值。
引用类型的值是保存在内存中的对象。与其他语言不同，**js不允许访问内存中的位置**，也就是说不能直接操作对象的内存空间。在操作对象时，实际上是在操作对象的引用而不是实际的对象。引用类型的值是按引用访问的，但是在为对象添加属性时，操作的是实际的对象。

基本类型的复制，被赋值是新的变量，之后互不干扰
而引用类型，在赋值时，新的变量放到新的空间，但是这个值的副本实际上是一个指针。因此，改变一个变量，就会影响另一个对象。
```javascript
var obj1 = new Object();
var obj2 = obj1;
obj1.name = "xx";
alert(obj2.name);  // xx
```
js所有函数的参数都是按值传递的。

typeof null => object
所有引用类型都是Object的实例，instanceof任意一个引用类型都是true，比如array  instanceof Object;但是检测不了基本类型。

每个函数都有一个执行环境，当执行流进入一个函数时，函数的环境就会被推入一个环境栈中。而在函数执行之后，栈将其执行环境弹出，把控制权返回给之前的执行环境。ECMAScript程序中执行流是由这样一个机制控制着。
作用域链的用途是保证对执行环境有权访问的所有变量和函数的有序访问。作用域链的前端，始终都是当前代码所在环境的变量对象。如果这个环境是函数，则将其活动对象作为变量对象。活动对象即arguments对象。

js没有块级作用域，if、for花括号后括号内的声明依然保留

## 垃圾回收机制
js垃圾回收机制：找出那些不在继续使用的变量，然后释放其占用的内存。垃圾回收机制会按照固定的时间间隔，周期性的执行操作。
通常的垃圾回收策略：
**1、标记清除：**
在垃圾回收机制运行的时候给存储在内存中的所有变量都加上标记。如果有被引用的变量，则清除掉标记。还有标记的被清除，收回它们所占的内存空间。
**2、计数引用**
跟踪记录每个值被引用的次数。声明的时候是1，在赋值给其他变量是为2，被赋值的变量得到另一个值，引用次数为1。引用次数变成0的时候，就清除。但是会有循环引用的情况，导致永远不为0。
在ie7-中，垃圾回收机制是根据内存分配量运行的，达到固定的临界值，再运行GC机制。问题在于，如果脚本中有大量的变量，会导致GC一直在运行。之后的ie采用了动态计算临界值的方法。
